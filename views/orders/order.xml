<?xml version="1.0"?>
<openerp>
    <data>
        


<!-- FORM -->
        <record model="ir.ui.view" id="view_order_form">
            <field name="name">sale.order.form</field>
            <field name="model">sale.order</field>          
            <field name="inherit_id" ref="sale.view_order_form"/>   


            <field name="mode">primary</field>
<!--
            <field name="priority" eval="1"/>
-->
            <field name="priority" eval="0"/>


            <field name="arch" type="xml">




                <!-- Status Bar --> 
                <xpath expr="//field[@name='state']" position="replace">
                    <field  name="state" 
                            widget="statusbar"                            
                            statusbar_visible="draft, verified, sent, sale"
                    />
                </xpath>








<!-- REPLACES -->
<!-- OLD Buttons - Take them out - NOT DEPRECATED --> 

                <!-- Two times important --> 

                <!-- Quotation Send --> 
                <xpath expr="//button[@name='action_quotation_send']" position="replace">
                </xpath>
                <xpath expr="//button[@name='action_quotation_send']" position="replace">
                </xpath>

                <!-- Print Quotation -->
                <xpath expr="//button[@name='print_quotation']" position="replace">
                </xpath>
                <xpath expr="//button[@name='print_quotation']" position="replace">
                </xpath>

                <!-- Action Done --> 
                <xpath expr="//button[@name='action_done']" position="replace">
                </xpath>

                <!-- Confirm Sale --> 
                <xpath expr="//button[@name='action_confirm']" position="replace">
                </xpath>

                <!-- OLD Buttons - DEPRECATED --> 
                <xpath expr="//button[@type='action']" position="replace">
                </xpath>
                <xpath expr="//button[@type='action']" position="replace">
                </xpath>







<!-- REDEFINE -->

                <!-- Redefine -->
                <xpath expr="//button[@name='action_confirm']" position="replace">


                    <!-- Validate -->
                    <button 
                            type="object" 
                            class="oe_highlight"
                            name="validate"

                            string="Validar"                            

                            states="sent"                       
                    />


                    <!-- Confirm -->
                    <button 
                            type="object" 
                            class="oe_highlight"
                            name="action_confirm_nex"

                            string="CONFIRMAR"
                            
                            states="validated"                      
                    />



                    <!-- Correct -->
                    <button 
                            type="object" 
                            class="oe_highlight"
                            name="correct_pm"

                            string="Corregir"
                            
                            states="sale"                       
                    />



                    <!-- Cancel --> 
                    <button 
                            name="cancel_order"     
                            type="object" 
                            class="oe_highlight"    
                            groups="openhealth.roots,openhealth.caja,openhealth.managers,openhealth.directors"

                            string="Anular"

                            states="sale"                       
                    />



                    <!-- Activate --> 
                    <button 
                            type="object" 
                            class="oe_highlight"    
                            name="activate_order"   
                            groups="openhealth.roots,openhealth.caja,openhealth.managers,openhealth.directors"

                            string="Activar"

                            states="cancel"                     
                    />


                    <!-- Create CN -->
                    <button
                            type="object"
                            class="oe_highlight"
                            name="create_credit_note"

                            states="sale,cancel"                     

                            string="Crear NC"
                    />


                    <!-- Checksum -->
                    <button
                            type="object"
                            class="oe_highlight"
                            groups="openhealth.roots"
                            
                            name="checksum"

                            string="CHECKSUM"

                            states="sale,cancel"                     
                    />


                    <!-- Payment -->
                    <button
                            type="object"
                            class="oe_highlight"
                            groups="openhealth.roots"
                            
                            name="update_payment"

                            string="PAYMENT"

                            states="sale"                     
                    />

                </xpath>







<!-- Natives -->
                <xpath expr="//field[@name='validity_date']" position="before">
                    
                    <field name="x_partner_vip"/>

                    <field name="vspace"/>

                    <field name="date_order"            string="Fecha"

                                                        attrs="{     
                                                                        'readonly': [
                                                                                        ('x_admin_mode', '!=', True), 
                                                                                    ], 
                                                            }"
                                                />

                    <field name="vspace"/>



                    <field name="x_payment_method"      attrs="{'readonly': [('x_admin_mode', '!=', True),],}"/>



                    <field name="x_type"
                                                        attrs="{     
                                                                        'readonly': [
                                                                                        ('x_admin_mode', '!=', True), 
                                                                                    ], 
                                                                }"  
                                        />


                    <field name="x_type_code"           groups="openhealth.roots"/>
<!--
                    <field name="x_pm_total"/>
-->
                    <field name="vspace"/>

                    <field name="x_serial_nr"       attrs="{     
                                                                        'readonly': [
                                                                                        ('x_admin_mode', '!=', True), 
                                                                                    ], 
                                                                }"  

                            />

                    <field name="x_counter_value"       groups="openhealth.roots"   

                                                        attrs="{     
                                                                        'readonly': [
                                                                                        ('x_admin_mode', '!=', True), 
                                                                                    ], 
                                                                }"  
                        />

                    <field name="vspace"/>

                    <field name="x_electronic"          groups="openhealth.roots"/>

                </xpath>





<!-- REDEFINE -->
                <!-- Price list --> 
                <xpath expr="//field[@name='pricelist_id']" position="replace">

                    <field name="x_checksum"                groups="openhealth.roots"/>
                    <field name="x_pm_total"                groups="openhealth.roots"/>

                    <field name="x_admin_mode"              groups="openhealth.roots, openhealth.managers, openhealth.caja"/>
                    
                    <field name="pricelist_id"              readonly="1"/>
                </xpath>














<!-- REPLACES -->
                <xpath expr="//field[@name='validity_date']" position="replace">
                </xpath>

                <xpath expr="//field[@name='payment_term_id']" position="replace">
                </xpath>









<!-- NEW BUTTONS --> 
                <xpath expr="//button[@name='action_confirm_nex']" position="before">
                





                    <!-- Print Electronic --> 
                    <button 
                            type="object"
                            class="oe_highlight"
                            attrs="{'invisible':[   '|',
                                                    ('x_type','not in',['ticket_invoice','ticket_receipt']),
                                                    ('state','not in',['sale', 'credit_note']), 
                                            ]}"
                            name="print_ticket_electronic"
                            groups="openhealth.roots, openhealth.caja, openhealth.managers"

                            string="Imprimir - Electrónico"
                        />









<!--
                    groups="openhealth.roots,openhealth.caja,openhealth.reception,openhealth.directors,openhealth.physicians,openhealth.managers"
-->
                    <!-- Add Prod -->
                    <button 
                            type="object" 
                            class="oe_highlight"
                            name="open_product_selector_product"                            

                            string="Agregar PRODUCTO"

                            states="draft"                      
                        />



<!--
                    groups="openhealth.roots,openhealth.caja,openhealth.reception,openhealth.directors,openhealth.physicians,openhealth.managers"
--> 
                    <!-- Add Serv -->
                    <button 
                            type="object" 
                            class="oe_highlight"
                            name="open_product_selector_service"

                            string="Agregar SERVICIO"

                            states="draft"
                        />





                    <!-- Pay -->
                    <button 
                            name="create_payment_method"
                            type="object" 
                            class="oe_highlight"
                            groups="openhealth.roots,openhealth.caja,openhealth.directors"

                            string="PAGAR"

                            states="draft"                      
                        />
                </xpath>














<!-- REPLACE --> 
                <!-- Buttons --> 
                <xpath expr="//button[@name='action_cancel']" position="replace">
                </xpath>

                <!-- Buttons --> 
                <xpath expr="//button[@name='action_draft']" position="replace">
                </xpath>






<!-- REDEFINE --> 
                <xpath expr="//field[@name='name']" position="replace">

                    <group>
                        <h3>
<!--                            
                            <field name="name"      readonly="1"/>
-->
                            <field name="x_title"       readonly="0"/>
                        </h3>
                    </group>

<!--
                    <group>
                        <group class="">
                            <h5>
                                <field name="treatment"     readonly="1"/>
                                <field name="cosmetology"   readonly="1"/>
                            </h5>
                        </group>
                    </group>
-->
                    <group></group>
                    <group></group>
                    <group></group>
                </xpath>







<!-- REPLACE --> 
                <!-- User --> 
                <field name="user_id" position="replace">
                </field>


                <!-- Partner --> 
                <field name="partner_id" position="replace">
                    <field name="patient"       required="1"            options="{'no_create': False, 'no_create_edit':True}"       />
                </field>


                <!-- Dni --> 
                <field name="patient" position="before">
                    <field name="x_credit_note"         attrs="{'invisible':[('state', 'not in', ['cancel'])]}"/>
                    <field name="x_credit_note_type"    attrs="{'invisible':[('state', 'not in', ['credit_note'])]}"/>
                    <field name="x_credit_note_owner"   attrs="{'invisible':[('state', 'not in', ['credit_note'])]}"/>
                    <field name="vspace"/>
                    
                    <field name="x_partner_dni"
                                                            attrs="{
                                                                        'readonly':[('patient', '!=', False)], 
                                                                }"
                        />
                    
                    <field name="vspace"/>
                </field>



                <!-- Id Docs -->
                <field name="patient" position="after"  >

                    <field name="x_id_doc_type"     
                                                        attrs="{
                                                                        'required':[('x_type', 'not in', ['ticket_invoice', 'invoice'])], 
                                                                }"
                        />

                    <field name="x_id_doc"          
                                                        attrs="{
                                                                        'required':[('x_type', 'not in', ['ticket_invoice', 'invoice'])], 
                                                                }"

                        />

                    <field name="x_dni"/>

                    <field name="vspace"/>

                    <field name="x_ruc"
                                                        attrs="{
                                                                        'required':[('x_type', 'in', ['ticket_invoice', 'invoice'])], 
                                                                }"
                        />
                </field>



                <!-- New Natives --> 
                <field name="x_ruc" position="after">

                    <field name="vspace"/>

                    <field name="x_doctor"      required="1"        options="{'no_create': True, 'no_create_edit':True}"            

                                                                    attrs="{     
                                                                                'readonly': [
                                                                                                ('x_admin_mode', '!=', True),
                                                                                                ('state', 'not in', ['draft']), 
                                                                                            ], 
                                                                        }"  
                                        />

                    <field name="vspace"/>

                    <field name="treatment"         
                                                                    attrs="{     
                                                                                'readonly': [
                                                                                                ('x_admin_mode', '!=', True),
                                                                                            ], 
                                                                        }"  

                        />

                    <field name="vspace"/>

                    <field name="x_family"      readonly="1"    />
                    
                    <field name="x_product"     readonly="1"    />
                </field>    



                <!-- Buttons - Post Mortem --> 
                <field name="amount_total" position="after">                        
                        <group class="oe_left"  style="width: 600px;">
                            <group col='5'      groups="openhealth.roots,openhealth.caja,openhealth.directors">


                                <!-- Cancel Boolean -->
                                <!--
                                <group>
                                    <field 
                                            name="x_cancel" 
                                            nolabel="1" 
                                            readonly="1"

                                            groups="openhealth.roots,openhealth.caja,openhealth.managers,openhealth.directors" />
                                </group>
                                -->


<!--
                                        groups="openhealth.roots"
-->
                                <!-- Reset --> 
                                <button 
                                        type="object" 
                                        class="oe_highlight"
                                        name="reset"

                                        groups="openhealth.roots,openhealth.caja"

                                        string="Reset"
                                />


                                <!-- Remove --> 
                                <group>
                                    <button 
                                            name="remove_myself"    
                                            type="object" 
                                            class="oe_highlight"
                                            groups="openhealth.roots"

                                            string="Remove"
                                    />

                                </group>
                            </group>
                        </group>
                </field>





<!-- Translate for Order Lines  -->
<xpath expr="//page[1]" position="attributes">
    <attribute name='string'>Líneas</attribute> 
</xpath>


<!-- Order Lines  -->
<!-- Must be ReadOnly for: Sale and Cancel -->
<xpath expr="//field[@name='order_line']" position="attributes">

    <attribute name='attrs'>{'readonly': [('state', 'in', ('sale','cancel','sent','validated'))]}</attribute>
</xpath>







<!-- Hide --> 
<xpath expr="//tree/field[@name='tax_id']" position="replace">
    <field name="tax_id"    readonly="1"        invisible="1"       />
</xpath>

<xpath expr="//tree/field[@name='name']" position="replace">
    <field name="name"  readonly="0"    invisible="0"       />
</xpath>





<!-- Change --> 
<xpath expr="//tree/field[@name='product_id']" position="replace">
    <field name="product_id"    options="{'no_create': True, 'no_create_edit':True}"/>
</xpath>



<!-- Add -->

<!-- Short name --> 
<xpath expr="//tree/field[@name='name']" position="after">
    <field name="x_description"/>
</xpath>





<!-- 
Chatter - Deprecated !!!
Look for the Minimalist experience !!!
-->
                <field name="message_follower_ids" position="replace">
                </field>


                <!-- QR -->
                <field name="message_ids" position="replace">
                    <group col="1">
                        <group>
                            <field name="x_qr_data"/>
                        </group>
                    </group>
                    <group col="1">
                        <group>
                            <field name="x_qr_img" widget="image"/>
                        </group>
                    </group>
                </field>


            </field>
        </record>
        <!-- END -->
        





<!-- TREE --> 
        <record model="ir.ui.view" id="sale.view_order_tree">
            <field name="name">sale.order.tree</field>
            <field name="model">sale.order</field>
            <field name="arch" type="xml">

                <tree string="Order Tree"

                        colors="
                        red:state=='draft';
                        green:state=='credit_note';
                        blue:state=='sale';
                        grey:state in ('cancel')
                        "
                    >

                    <field name="name"          string="Referencia"/>
                    <field name="date_order"    string="Fecha"/>
                    <field name="x_serial_nr" />
                    <field name="x_counter_value"   groups="openhealth.roots"/>
                    <field name="x_electronic"  groups="openhealth.roots"/>
                    

                    <field name="x_payment_method"/>
                    <field name="x_checksum"    groups="openhealth.roots"   />


                    <field name="x_qr_img"  groups="openhealth.roots"/>

                    <field name="x_type" />
                    <field name="x_type_code"   groups="openhealth.roots"/>
                    <field name="state"/>

                    <field name="x_id_doc_type"/>
                    <field name="x_id_doc"/>
                    <field name="x_ruc"/>

                    <field name="x_delta"           groups="openhealth.roots"/>




                    <field name="patient"/>
                    <field name="x_doctor"/>
                    <field name="treatment"/>
                    <field name="nr_lines"/>
                    <field name="x_family"/>
                    <field name="x_product"/>

                    <field name="amount_untaxed"    sum="Total Untaxed"         widget="monetary"       string="Total"  />

                    <field name="user_id"       string="Creado por" />

<!--
                    <field name="x_qr_data"     groups="openhealth.roots"/>
                    <field name="x_pm_total"    groups="openhealth.roots"   />
-->
                </tree>
            </field>
        </record>
<!--
                    <field name="x_legacy"      groups="openhealth.roots"/>
                    <field name="create_date" />
                    <field name="write_date" />
                    <field name="create_date"/>
                    <field name="user_id"       string="Generado por"   />
                    <field name="comment"/>
                    <field name="note"/>
                    <field name="partner_id"/>
                    <field name="product"/>
                    <field name="x_date_order_corr" string="Fec"    />
                    <field name="x_note"/>
-->







<!-- TREE 2  - DELTA --> 
        <record model="ir.ui.view" id="view_order_delta_tree">
            <field name="name">sale.order.tree</field>
            <field name="model">sale.order</field>
            <field name="arch" type="xml">

<!--
                        blue:state=='sale';
                        green:state=='credit_note';
                        grey:state in ('cancel')
-->
                <tree string="Order Tree"

                        colors="
                        red:x_delta!=1
                        "
                    >

                    <field name="name"          string="Referencia"/>
                    
                    <field name="x_type"/>
                    <field name="state"/>
                    
                    <field name="x_serial_nr"/>
                    <field name="x_counter_value"/>

                    <field name="x_delta"/>

<!--                    
                    <field name="x_checksum"    />
                    <field name="x_pm_total"    groups="openhealth.roots"   />
                    <field name="user_id"       string="Creado por" />
                    <field name="x_family" />
                    <field name="x_product"/>
                    <field name="x_doctor" />
                    <field name="treatment" />
                    <field name="state"/>
-->
                    <field name="date_order"    string="Fecha"  />
                    <field name="patient"/>
                    <field name="nr_lines"/>
                    <field name="amount_untaxed"    sum="Total Untaxed"         widget="monetary"       string="Total"  />
                </tree>
            </field>
        </record>
<!--
                    <field name="user_id"       string="Generado por"   />
                    <field name="comment"/>
                    <field name="note"/>
                    <field name="partner_id"/>
                    <field name="product"/>
                    <field name="x_date_order_corr" string="Fec"    />
                    <field name="x_note"/>
-->





<!-- TREE 3 - CHECKSUM -->
        <record model="ir.ui.view" id="view_order_checksum_tree">
            <field name="name">sale.order.tree</field>
            <field name="model">sale.order</field>
            <field name="arch" type="xml">

                <tree string="Order Tree"
                        colors="

                        red:x_checksum!=0;
                        
                        grey:x_checksum==-1
                        
                        "
                    >

                    <field name="name"          string="Referencia"     />
                    
                    <field name="x_type" />
                    <field name="state"/>
                    
                    <field name="x_serial_nr" />
                    <field name="x_checksum"    />

                    <field name="x_payment_method"/>
                    <field name="x_pm_total"/>

                    <field name="date_order"    string="Fecha"  />
                    <field name="patient"/>

                    <field name="x_doctor" />
                    <field name="treatment" />

                    <field name="nr_lines"/>
                    <field name="x_family" />
                    <field name="x_product"/>
                    <field name="amount_untaxed"    sum="Total Untaxed"         widget="monetary"       string="Total"  />
<!--
                    <field name="state"/>
                    <field name="user_id"       string="Creado por" />
-->            
                </tree>
            </field>
        </record>
<!--
                    <field name="user_id"       string="Generado por"   />
                    <field name="comment"/>
                    <field name="note"/>
                    <field name="partner_id"/>
                    <field name="product"/>
                    <field name="x_date_order_corr" string="Fec"    />
                    <field name="x_note"/>
-->




<!-- TREE 4 - PAYMENT -->
        <record model="ir.ui.view" id="view_order_payment_tree">
            <field name="name">sale.order.tree</field>
            <field name="model">sale.order</field>
            <field name="arch" type="xml">

                <tree string="Order Tree">

                    <field name="name"          string="Referencia"/>
                    
                    <field name="x_type"/>
                    
                    <field name="state"/>
                    
                    <field name="x_serial_nr" />
                    
                    <field name="x_checksum"    />

                    <field name="x_payment_method"/>
                    
                    <field name="x_pm_total"/>

<!--
-->
                    <field name="x_pm_cash"/>
                    
                    <field name="x_pm_visa_credit"/>
                    <field name="x_pm_visa_debit"/>
                    
                    <field name="x_pm_master_credit"/>
                    <field name="x_pm_master_debit"/>
                    
                    <field name="x_pm_american"/>
                    <field name="x_pm_diners"/>

                </tree>
            </field>
        </record>





    </data>
</openerp>
