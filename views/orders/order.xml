<?xml version="1.0"?>

<!--
	*** OPEN HEALTH

	Created: 			   Aug 2016
	Last updated: 	 	 5 Apr 2017
-->

<openerp>
	<data>
		


		<!-- Form view -->
		<record model="ir.ui.view" id="view_order_form">

			<field name="name">sale.order.form</field>
			
			<field name="model">sale.order</field>


			<field name="inherit_id" ref="sale.view_order_form"/>			
	        <field name="mode">primary</field>
	        <field name="priority" eval="1"/>

	        
			<field name="arch" type="xml">







				<!-- State --> 
<!--
							attrs="{		'invisible':[('x_family', '!=', 'procedure' ),],
									}"							
							statusbar_visible="draft, payment, proof, machine, sale, invoice"
							statusbar_visible="draft, payment, proof, sale, invoice, done"
-->	



				<xpath expr="//field[@name='state']" position="replace">
					<field 	name="state" 
							widget="statusbar" 

							statusbar_visible="draft, payment, proof, sale, invoice"
					/>
				</xpath>







<!-- OLD Buttons - DEPRECATED --> 

				<!-- Two times important --> 


				<!-- Quotation Send --> 
				<xpath expr="//button[@name='action_quotation_send']" position="replace">
				</xpath>
				<xpath expr="//button[@name='action_quotation_send']" position="replace">
				</xpath>


				<!-- Print Quotation -->
				<xpath expr="//button[@name='print_quotation']" position="replace">
				</xpath>
				<xpath expr="//button[@name='print_quotation']" position="replace">
				</xpath>




				<!-- Action Confirm --> 
				<!--
				<xpath expr="//button[@name='action_confirm']" position="replace">
				</xpath>
				<xpath expr="//button[@name='action_confirm']" position="replace">
				</xpath>
				-->

				<!-- Action Done --> 
				<!--
				-->
				<xpath expr="//button[@name='action_done']" position="replace">
				</xpath>







				<!--
				<xpath expr="//page[@name='Other Information']" position="replace">

				</xpath>
				-->






				<!-- Create Invoice --> 
<!--
				<xpath expr="//button[contains(text(),'Create')]" position="replace">

				<xpath expr="//button[@name='225']" position="replace">
				<xpath expr="//button[@string='Create Invoice']" position="replace">
				</xpath>
-->


				<xpath expr="//button[@type='action']" position="replace">
				</xpath>
				<xpath expr="//button[@type='action']" position="replace">
				</xpath>






<!--
-->
				<xpath expr="//field[@name='validity_date']" position="before">
					<field name="x_amount_total" />
					<field name="pm_total" />
					<field name="pm_complete" />
					<field name="vspace" />
				</xpath>



<!--
				<xpath expr="//field[@name='amount_total']" position="replace">
					<field name="x_amount_total" />
				</xpath>
-->

				<!--
				<xpath expr="//field[@name='amount_total']" position="replace">
				</xpath>
				-->



				<xpath expr="//field[@name='validity_date']" position="replace">

					<field name="x_machine"		attrs="{	'invisible':[('patient', '=', False ),],
															}"	/>
				
				</xpath>



				<!--
				<xpath expr="//field[@name='validity_date']" position="after">
				-->
				<xpath expr="//field[@name='x_machine']" position="after">

					<group	attrs="{	'invisible':[('patient', '=', False ),],
												}"	>



					<field name="vspace" />

					<field name="patient" />


<!--
					
					<field name="x_therapist" />
					
					
					<field name="consultation"		attrs="{
														'invisible':[('consultation', '=', False ),],
														}"	/>

					<field name="x_doctor"		attrs="{
														'invisible':[('x_doctor', '=', False ),],
														}"	/>
														
					
					<field name="x_therapist"		attrs="{
														'invisible':[('x_therapist', '=', False ),],
														}"	/>
-->



					<field name="x_doctor" />




					<field name="consultation"/>

					<field name="x_appointment"/>
					<field name="x_appointment_date"/>
					<field name="x_duration"/>




<!--
					<field name="vspace"/>
-->
					<field name="cosmetology"	attrs="{
														'invisible':[('cosmetology', '=', False ),],
														}"	/>
					
<!--
					<field name="treatment"		attrs="{
														'invisible':[('treatment', '=', False ),],
														}"	/>
-->

					</group>
				</xpath>




				<xpath expr="//field[@name='payment_term_id']" position="replace">
				</xpath>











	


				<!--
				<xpath expr="pass of position" position="the postion">
				-->		









<!--

<xpath expr="//page[@string='Other Information']" position="replace">
</xpath>


<xpath expr="//page[@string='Other Information']" position="attributes" >
    <attribute name="invisible">1</attribute>
</xpath>


<xpath expr="/form/notebook/page[@string='Other Information']" position="attributes">
    <attribute name="invisible">1</attribute>
</xpath>


<page string="Other Information" position="attributes">
	<attribute name='invisible'>1</attribute> 
</page>
-->






<xpath expr="//page[1]" position="attributes">

	<attribute name='string'>Líneas</attribute> 

</xpath>




<xpath expr="//page[2]" position="attributes">
	<attribute name='invisible'>1</attribute> 
</xpath>




				<!-- NEW BUTTONS --> 
<!--
				<xpath expr="//field[@name='x_state']" position="before">
-->
				<xpath expr="//field[@name='state']" position="before">
				




					<!-- Treatment --> 
					<button 
							name="open_treatment"

							type="object" 

							class="oe_highlight"

							string="INICIO"


							states="sale"						
					/>






					<!-- Pagar -->
<!--
							attrs="{'invisible':	[('x_state', 'in', ['payment', 'proof', 'machine', 'sale', 'invoice'] ),	]}"
-->					
					<button 
							type="object" 
							class="oe_highlight"

							string="Pagar"

							states="draft"						


							name="create_payment_method"
							/>






					<!--

							attrs="{'invisible':	[('x_state', 'in', ['draft', 'proof',  'machine', 'sale', 'invoice'] ),	]}"
					-->
					<button 
							type="object" 
							class="oe_highlight"

							string="Comprobante" 


							states="payment"						


							name="create_sale_document" 
					/>
















					<!-- Reserve Machine --> 
<!--
							states="proof"						
							attrs="{'invisible':	[('x_state', 'in', ['draft', 'payment',  'machine', 'sale', 'invoice'] ),	]}"


							attrs="{'invisible':	[('x_family', 'in', ['consultation'] 	),	]}"

							states="proof"

														('state','=','proof'),
							attrs="{'invisible':	[
														('x_family','!=','procedure'), 

													]}"

																('x_machine','!=',''), 
-->

					<button 
							type="object"

							name="reserve_machine" 	

							class="oe_highlight"


							string="Reservar la Sala"




							attrs="{'invisible':		['|',
																('x_family','!=','procedure'),

																('state','!=','proof'), 

																('x_machine','=',False), 
									]}"

					/>







					<!-- Confirm -->
<!--
							attrs="{'invisible':
												[
													('pm_complete', '=', False),
												]
									}"


							attrs="{'invisible':	[('x_state', 'in', ['draft', 'payment', 'proof',   'sale', 'invoice'] ),	]}"
							states="proof"						

							attrs="{'invisible':	[('x_state', 'in', ['draft', 'payment',  'machine', 'sale', 'invoice'] ),	]}"


							states="machine"
-->

					<button 
									
							type="object" 
							class="oe_highlight"

							string="Confirmar" 


							states="proof"


							name="action_confirm" 
					/>




					<!-- Create Invoice --> 
<!--

					<button 
							type="object"
							class="oe_highlight"
							string="Crear Factura"
						
							states="sale"		

							name="x_create_invoice" 	
					/>
-->

				</xpath>











<!--
-->
				<xpath expr="//button[@name='action_confirm']" position="replace">
				</xpath>

				<xpath expr="//button[@name='action_confirm']" position="replace">
				</xpath>











				<!-- Buttons --> 
<!--				
				<xpath expr="//button[@name='print_quotation']" position="replace">
				</xpath>
-->
				<xpath expr="//button[@name='action_cancel']" position="replace">
				</xpath>






				<!-- Remove -->
				<xpath expr="//field[@name='name']" position="replace">



					<group>
						<h3>
							<div attrs="{'invisible':[	('state', '!=', 'draft'), ]}">
								Presupuesto
							</div>
						
							<div attrs="{'invisible':[	('state', '!=', 'sale'), ]}">
								Venta
							</div>
						</h3>
					</group>



					<group>
						<group class="oe_left"  style="width: 600px;">
							<h4><field name="name" 	class=""/></h4>
						</group>

						<group class="">
							<h5><field name="treatment" class=""/></h5>
						</group>
					</group>







					<group col='5'>
					

						<!-- Update --> 
						<group>
							<button 
								type="object" 
								class="oe_highlight"

								string="Actualizar"

								name="update_order" 	
							/>
						</group>



						<!-- Reset --> 
						<group>

							<button 
								type="object" 
								class="oe_highlight"

								string="Reiniciar"

								name="x_reset" 	
							/>
						
						</group>







						<!-- Remove --> 
						<group>
							<button 
								groups="openhealth.admins"

								type="object" 
								class="oe_highlight "

								string="Eliminar" 

								name="remove_myself" 
							/>
						</group>

						<!-- Cancel --> 
						<group>
							<button 
								groups="openhealth.admins"

								type="object" 
								class="oe_highlight oe_right "	
								string="Anular"
								name="cancel_order" 	
							/>
						</group>

						<group>
        	            	<field name="x_cancel"  nolabel="1"	 groups="openhealth.admins"/>
						</group>

					</group>




						<!--
						<group>
							<button 
								type="object" 
								class="oe_highlight oe_right"	
								string="Activar"
								name="activate_order" 	
							/>
						</group>
						-->

				</xpath>





<!--
EC2
				<xpath expr="//field[@name='margin']" position="replace">
				</xpath>
-->				



<!--
Order Line - Tree
-->
<!--
				<xpath expr="//field[@name='order_line']" position="replace">
					<field name="order_line">
						<tree string="Order Line Tree">
					

    	                	<field name="product_id" 		string="Producto"/>

        	            	<field name="name"				string="Descripción" />



        	            	<field name="x_partner_vip"		string="Vip"/>

        	            	<field name="product_uom_qty"	string="Cantidad"/>

            	        	<field name="price_unit"		string="Precio"/>

            	        	<field name="x_price_vip"		/>

            	        	<field name="price_subtotal"	/>

						</tree>
					</field>
				</xpath>



				<xpath expr="//field[@name='price_subtotal']" position="before">
            	        <field name="x_price_vip"/>
				</xpath>


				<xpath expr="//field	[@name='order_line']/tree//field[@name='price_unit']" position="after">
                	<field name="purchase_price" groups="base.group_user"  string='jx'/>
            	</xpath>
-->			



				<xpath expr="//field	[@name='order_line']/tree//field[@name='price_subtotal']" position="before">
            	        <field name="x_price_vip"/>
            	</xpath>

<!--
				<xpath expr="//field	[@name='order_line']/tree//field[@name='purchase_price']" position="replace">
                	<field name="purchase_price" invisible="1"/>
            	</xpath>
-->




<!--
				<xpath expr="//field	[@name='order_line']/tree//field[@name='name']" position="after">
        	            <field name="x_partner_vip"		string="Vip"/>
            	</xpath>
-->
				<xpath expr="//field	[@name='order_line']/tree//field[@name='tax_id']" position="replace">
            	</xpath>



				<xpath expr="//field	[@name='order_line']/tree//field[@name='product_uom_qty']" position="replace">
        	            <field name="product_uom_qty"	string="Cantidad"/>
            	</xpath>




				<!--				
				Order Line - Replace    
				<field name="order_line" position="replace">





					<field name="vspace"/>
					<group col="3">

						<group>
						</group>

						<group>
						</group>

						<group>
							<field name="x_price_total"/>
							<field name="x_price_vip_total"/>
						</group>
					</group>

				</field>
				-->








				<field name="amount_untaxed" position="replace">
				</field>

				<field name="amount_tax" position="replace">
				</field>



				
				



				
				<field name="partner_id" position="after">
<!--				
					<field name="x_partner_name"/>
					<field name="doctor_name"/>
-->

					<!--
					<field name="vspace"/>
					-->
					
					<field name="x_partner_vip"/>
					
					<field name="vspace"/>



<!--					
					<field name="x_state"		string="x Estado"/>

					<field name="state"		string="Estado"/>
-->








					<!--
					<group>
						<group>
							<field name="x_payment_method"/>
							<button 
								type="object" 
								class="oe_highlight"	

								string="Crear MP"
						
								name="create_payment_method" 	
							/>
						</group>
					</group>
					-->









					<!--
					<field name="x_payment_method_code" 	required="0" 	attrs="{'invisible':[
																				
																					('x_payment_method', '!=', 'debit_visa'), 
																					('x_payment_method', '!=', 'debit_master'), 
																					
																					('x_payment_method', '!=', 'credit_visa'), 
																					('x_payment_method', '!=', 'credit_master'), 
																				
																					('x_payment_method', '!=', 'diners'), 
																					('x_payment_method', '!=', 'american_express'), 
																				]}"			/>
					-->

					<field name="vspace"/>
					
					<field name="vspace"/>
					<field name="x_sale_document"/>
					<field name="vspace"/>			


					<field name="x_family"/>


<!--
					<field name="x_payment_method"/>
					<field name="vspace"/>
-->


					<field name="x_ruc"			attrs="{'invisible':[('x_sale_document', '!=', 'invoice')]}"	/>





					<field name="receipt" 		attrs="{'invisible':[('x_sale_document', '!=', 'receipt')]}"	/>
					<field name="x_invoice"		attrs="{'invisible':[('x_sale_document', '!=', 'invoice')]}"	/>

					<field name="x_advertisement"		attrs="{'invisible':[('x_sale_document', '!=', 'advertisement')]}"	/>
					<field name="x_sale_note"			attrs="{'invisible':[('x_sale_document', '!=', 'sale_note')]}"		/>
					<field name="x_ticket_receipt"		attrs="{'invisible':[('x_sale_document', '!=', 'ticket_receipt')]}"	/>
					<field name="x_ticket_invoice"		attrs="{'invisible':[('x_sale_document', '!=', 'ticket_invoice')]}"	/>





<!--
					<field name="vspace"/>
					<field name="x_product"/>
					<field name="x_machine_req"/>
					<field name="x_target"/>
-->


					
					<!--
					<field name='field_One2many'>
						<tree>
							
						</tree>
					</field>
					-->
						
				</field>
				<!--
				</xpath>
				-->
				
				
			</field>
		</record>
		
		







		
		<!-- Tree view --> 
		<record model="ir.ui.view" id="sale.view_order_tree">
			<field name="name">sale.order.tree</field>
			<field name="model">sale.order</field>
			<field name="arch" type="xml">
				
				<tree string="Order Tree">
					


                    <field name="name"/>

                    <field name="partner_id"/>






					<field name="x_doctor"		/>


<!--
					<field name="x_target"/>
-->
					<field name="x_family"/>



                    <field name="state"/>
                    <field name="nr_lines"/>
                    <field name="x_amount_total" 	sum="Total Tax Included"	widget="monetary"/>
                    <field name="date_order"		string="Fecha"/>

<!--
                    <field name="name" string="Order Number"/>
                    <field name="name" string="Presupuesto #"	attrs="{'invisible':[('state', '!=', 'pre-draft')]}"/>
                    <field name="name" string="Factura #"		attrs="{'invisible':[('state', '!=', 'sale')]}"/>
                    <field name="id"/>
                    <field name="invoice_status"/>
					<field name="message_needaction" invisible="0"/>


                    <field name="receipt"/>
                    <field name="x_invoice"/>

                    <field name="user_id"		string="Vendido por"/>

                    <field name="x_chief_complaint"/>
                    <field name="consultation"/>
                    <field name="treatment"/>
                    <field name="id"/>

					<field name="order_line"/>
-->
				</tree>
			</field>
		</record>


		








		<!-- Window Form Action --> 
		<record model="ir.actions.act_window" id="order_form_action">
			<field name="name">orders</field>
			<field name="res_model">sale.order</field>
			<field name="view_type">form</field>

			<field name="view_mode">tree,form</field>
			
			<!--
			<field name="view_mode">form,tree</field>
            <field name="domain">[]</field>
            <field name="context">{}</field>
            <field name="view_id" eval="False"/>
			<field name="help" type="html">
				<p class="oe_view_nocontent_create">Create the first order
				</p>
			</field>
			-->
		</record>
		
		
		
		



		<!-- Window List action -->
		<!--
		The following tag is an action definition for a "window action",
		that is an action opening a view or a set of views
		-->
		<record model="ir.actions.act_window" id="order_list_action">
			<field name="name">Orders</field>
			<field name="res_model">sale.order</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form</field>
			<!--
            <field name="domain">[]</field>
            <field name="context">{}</field>
            <field name="view_id" eval="False"/>
			
			<field name="help" type="html">
				<p class="oe_view_nocontent_create">Create the first order
				</p>
			</field>
			-->
		</record>
		




		<!-- Budgets --> 
		<record model="ir.actions.act_window" id="budget_list_action">
			
			<field name="name">Presupuestos</field>
			
			<field name="res_model">sale.order</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form</field>

            <field name="domain">[
									('state', '=', 'draft'),
            					]
            </field>

			<!--
            <field name="domain">[]</field>
            
            <field name="context">{}</field>
            <field name="view_id" eval="False"/>
			
			<field name="help" type="html">
				<p class="oe_view_nocontent_create">Create the first budget
				</p>
			</field>
			-->
		</record>





		<!-- Sales --> 
		<record model="ir.actions.act_window" id="sale_list_action">
			<field name="name">Ventas</field>
			<field name="res_model">sale.order</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form</field>

           	<field name="domain">[
									('state', '=', 'sale'),
            					]
            </field>

			<!--
            <field name="domain">[]</field>
            <field name="context">{}</field>
            <field name="view_id" eval="False"/>
			<field name="help" type="html">
				<p class="oe_view_nocontent_create">Create the first invoice
				</p>
			</field>
			-->
		</record>


		<!-- Sales - Consultations --> 
		<record model="ir.actions.act_window" id="sale_cons_list_action">
			<field name="name">Ventas</field>
			<field name="res_model">sale.order</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form</field>

           	<field name="domain">[
									('state', '=', 'sale'),
									('x_family', '=', 'consultation'),
            					]
            </field>
		</record>


		<!-- Sales - Procedures --> 
		<record model="ir.actions.act_window" id="sale_proc_list_action">
			<field name="name">Ventas</field>
			<field name="res_model">sale.order</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form</field>

           	<field name="domain">[
									('state', '=', 'sale'),
									('x_family', '=', 'procedure'),
            					]
            </field>
		</record>
		









		<!--
		<record id="user_group_id" model="res.groups">
    		<field name="name">Open Health User Group</field>
    		<field name="category_id" ref="base.module_category_sales_management"/>
		</record>
		-->



		<!-- Menus --> 
		<!-- top level menu: no parent -->
		<menuitem id="main_openextension_menu" name="Open Health"/>

		<!-- A first level in the left side menu is needed
		before using action= attribute -->
		<menuitem id="openextension_menu" name="Open Health"
			parent="main_openextension_menu"/>

		<!-- the following menuitem should appear *after*
		its parent openextension_menu and *after* its
		action order_list_action -->
		<!--
		<menuitem id="orders_menu" name="Treatments" parent="openextension_menu"
		-->


		<!--
		<menuitem id="orders_menu" name="Presupuestos jx" parent="openextension_menu"
			action="order_list_action"  group="group_openhealth_user"/>
		-->
		<menuitem id="orders_menu" name="Presupuestos jx" parent="openextension_menu"
			action="order_list_action"/>



		<!-- Full id location:
		action="openextension.order_list_action"
		It is not required when it is the same module -->






		
		<!-- Filter --> 
        <record id="view_medical_order_filter" model="ir.ui.view">
           <field name="name">Order Search</field>
           <field name="model">sale.order</field>		   
		   <field name="arch" type="xml">
               <search string="orders">

                   <field name="partner_id" />
                   <field name="x_doctor" />               

                   <field name="x_family" />               
               
               </search>
           </field>
       </record>


<!--
        <record id="view_medical_order_filter_phy" model="ir.ui.view">
           <field name="name">Order Search</field>
           <field name="model">sale.order</field>		   
		   <field name="arch" type="xml">
               <search string="orders">
                   <field name="x_doctor" />                           
               </search>
           </field>
       </record>
-->




	</data>
</openerp>
