<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>



<!-- FORM --> 
        <record model="ir.ui.view" id="treatment_form_view">
            <field name="name">treatment.form</field>
            <field name="model">openhealth.treatment</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <form string="Treatment Form">
                    <header>

 <!-- Testing -->
<!--

                        <button 
                            type="object" 
                            class="oe_highlight"
                            
                            name="test" 
                            
                            string="TEST" 
                            
                            groups="openhealth.roots"

                            help='Tests: Reset, Integration, Create Recos, Computes'
                        />


                        <button 
                            type="object" 
                            class="oe_highlight"
                            
                            name="test_libs" 
                            
                            string="TEST LIBS" 
                            
                            groups="openhealth.roots"

                            help='Tests: Products, Reports, Patients, Payments'
                        />
-->




<!-- State Dependent -->
                        <!-- Create Appointment --> 
                        <!--
                        <button 
                            class="oe_highlight"
                            type="object"
                            name="create_appointment_consultation" 

                            
                            string="Crear CITA"
                            states="empty"
                        />
                        -->

                        <!-- Create Budget Consultation --> 
                        <button 
                            type="object" 
                            class="oe_highlight"
                            name="create_order_con"
                            string="Crear PRESUPUESTO - Consulta"
                            groups="openhealth.roots,openhealth.reception,openhealth.caja,openhealth.managers,openhealth.directors"

                            states="empty,appointment"
                        />

                        <!-- Create Consultation --> 
                        <button 
                            type="object" 
                            class="oe_highlight"                            
                            name="create_consultation"
                            string="Crear CONSULTA"
                            groups="openhealth.roots,openhealth.physicians,openhealth.managers,openhealth.directors"

                            states="invoice_consultation"
                        />

                        <!-- Create Reco --> 
                        <button 
                            type="object" 
                            class="oe_highlight"
                            name="create_service"
                            string="Crear RECOMENDACION" 
                            groups="openhealth.roots,openhealth.physicians,openhealth.managers,openhealth.directors"

                            states="consultation,service"
                        />

                        <!-- Create Order --> 
                        <button 
                            type="object" 
                            class="oe_highlight"
                            name="create_order_pro" 
                            string="Crear PRESUPUESTO - Pro" 
                    groups="openhealth.roots,openhealth.physicians,openhealth.reception,openhealth.caja,openhealth.managers,openhealth.directors"
                    
                            states="service"
                        />

                        <!-- Create Procedure --> 
                        <button 
                            type="object" 
                            class="oe_highlight"
                            name="create_procedure_man" 
                            string="Crear PROCEDIMIENTO" 
                            groups="openhealth.roots,openhealth.physicians,openhealth.managers,openhealth.directors"

                            states="invoice_procedure"
                        />



<!-- State less - Archivers -->
                        <!-- Create Consultation --> 
                        <button 
                            type="object" 
                            class="oe_highlight"
                            name="create_consultation" 
                            string="CON"

                            groups="openhealth.archivers"
                        />

                        <!-- Create Service --> 
                        <button 
                            type="object" 
                            class="oe_highlight"
                            name="create_service"
                            string="REC" 

                            groups="openhealth.archivers"
                        />

                        <!-- Create Order --> 
                        <button 
                            type="object" 
                            class="oe_highlight"
                            name="create_order_pro" 
                            string="PresPro" 

                            groups="openhealth.archivers"
                        />

                        <!-- Create Procedure --> 
                        <button 
                            type="object" 
                            class="oe_highlight"
                            name="create_procedure_man"
                            string="PRO" 

                            groups="openhealth.archivers"
                        />

                        <!-- Create New Procedure --> 
                        <button 
                            type="object" 
                            class="oe_highlight"
                            name="create_new_procedure"
                            string="Crear Nuevo PROCEDIMIENTO" 

                            states="empty"

                            groups="openhealth.archivers"
                        />



<!-- State -->
                        <field  name="state" 
                                widget="statusbar"
                                statusbar_visible="appointment, invoice_consultation, consultation, service, budget_procedure, invoice_procedure, procedure, sessions, controls, done"
                        />
                    </header>



<!-- Sheet -->  
                    <sheet>
                        <div>                       
                            <!-- Persona --> 
                            <div class="oe_left"  style="width: 250px;">
                                <div class="oe_title" >
                                    <h1 class="jx_title">Tratamiento</h1>   
                                </div>      
                                <group></group>
                                    <h2><field name="patient"/></h2>
                            </div>





<!-- Buttons --> 
                            <div class="oe_left" style="width: 400px;" name="buttons">
                            
                            
                                <!-- Appointments -->
<!--                                
                                <button type="action" class="oe_stat_button"
                                    name="%(appointment_form_action)d"
                                    context="{
                                                'default_treatment': active_id, 
                                            }"
                                    icon="fa-calendar"
                                    attrs="{ 'invisible':[  ('nr_appointments','=',0),  ]}"
                                    >
                                    <field string="Citas" name="nr_appointments" widget="statinfo"/>
                                </button>
-->

                                <!-- Budgets - Cons - IMPORTANT -->
                                <button type="action" class="oe_stat_button" icon="fa-list"
                                        attrs="{ 'invisible':[  ('nr_budgets_cons','=',0),  ]}"
                                        name="%(order_form_tre_action)d"
                                        context="{
                                                    'search_default_patient': patient,
                                                    'default_treatment': active_id,
                                                    'default_x_family': 'consultation', 
                                                }"  
                                        >
                                    <field string="Presu - Con" name="nr_budgets_cons" widget="statinfo"/>
                                </button>


                                <!-- Invoices - Con -->
                                <button type="action" class="oe_stat_button" icon="fa-list"
                                        attrs="{ 'invisible':[  ('nr_invoices_cons','in',[ False, 0, ]), ]}"
                                        name="%(order_form_tre_action)d"
                                        context="{                                  
                                                    'search_default_patient': patient,
                                                    'default_treatment': active_id,
                                                    'default_x_family': 'consultation', 
                                                }"  
                                        >
                                    <field string="Venta - Con" name="nr_invoices_cons" widget="statinfo"/>
                                </button>


                                <!-- Consultations -->
                                <button type="action" class="oe_stat_button"
                                    name="%(consultation_form_action)d"
                                    context="{                                  
                                                'search_default_treatment': active_id,
                                            }"
                                    icon="fa-list"
                                    attrs="{ 'invisible':[  ('nr_consultations','=',0), ]}"
                                    >
                                    <field string="Consulta" name="nr_consultations" widget="statinfo"/>
                                </button>


<!--
                                <button type="action" class="oe_stat_button" icon="fa-list" invisible="0"
-->
                                <!-- Services -->
                                <button type="action" class="oe_stat_button" icon="fa-list"
                                    
                                    name="%(service_list_action)d"
                                    
                                    context="{                                  
                                                'search_default_treatment': active_id,
                                            }"

                                    attrs="{ 'invisible':[  ('nr_services','=',0), ]}"
                                    
                                    >
                                    <field string="Recomendacion" name="nr_services" widget="statinfo"/>
                                </button>


                                <!-- Nr of Services - product --> 
                                <button type="action" class="oe_stat_button" icon="fa-list"
                                    name="%(service_product_list_action)d"
                                    context="{                                  
                                                'search_default_treatment': active_id,
                                            }"
                                    attrs="{ 'invisible':[  ('nr_services_product','=',0), ]}"
                                    >


                                    <field string="Reco Prod" name="nr_services_product" widget="statinfo"/>
                                </button>


                                <!-- Nr of Services - vip --> 
                                <button type="action" class="oe_stat_button" icon="fa-list"
                                    name="%(service_vip_list_action)d"
                                    context="{                                  
                                                'search_default_treatment': active_id,
                                            }"
                                    attrs="{ 'invisible':[  ('nr_services_vip','=',0), ]}"
                                    >
                                    <field string="Reco vip" name="nr_services_vip" widget="statinfo"/>
                                </button>


                                <!-- Nr of Services - Quick --> 
                                <button type="action" class="oe_stat_button" icon="fa-list"
                                    name="%(service_quick_list_action)d"
                                    attrs="{ 'invisible':[  ('nr_services_quick','=',0), ]}"
                                    context="{                                  
                                                'search_default_treatment': active_id,
                                            }"                                          
                                    >
                                    <field string="Reco Quick" name="nr_services_quick" widget="statinfo"/>
                                </button>


                                <!-- Nr of Services - Co2 --> 
                                <button type="action" class="oe_stat_button" icon="fa-list"
                                    name="%(service_co2_list_action)d"
                                    attrs="{ 'invisible':[  ('nr_services_co2','=',0), ]}"
                                    context="{                                  
                                                'search_default_treatment': active_id,
                                            }"                                          
                                    >
                                    <field string="Reco Co2" name="nr_services_co2" widget="statinfo"/>
                                </button>


                                <!-- Nr of Services - Exc --> 
                                <button type="action" class="oe_stat_button"  icon="fa-list"
                                    name="%(service_excilite_list_action)d"
                                    attrs="{ 'invisible':[  ('nr_services_excilite','=',0), ]}"
                                    context="{                                  
                                                'search_default_treatment': active_id,
                                            }"                                          
                                    >
                                    <field string="Reco Exc" name="nr_services_excilite" widget="statinfo"/>
                                </button>


                                <!-- Nr of Services - Ipl --> 
                                <button type="action" class="oe_stat_button" icon="fa-list"
                                    name="%(service_ipl_list_action)d"  
                                    attrs="{ 'invisible':[  ('nr_services_ipl','=',0), ]}"
                                    context="{                                  
                                                'search_default_treatment': active_id,
                                            }"                                          
                                    >
                                    <field string="Reco Ipl" name="nr_services_ipl" widget="statinfo"/>
                                </button>


                                <!-- Nr of Services - Ndyag --> 
                                <button type="action" class="oe_stat_button" icon="fa-list"
                                    name="%(service_ndyag_list_action)d"    
                                    attrs="{ 'invisible':[  ('nr_services_ndyag','=',0), ]}"
                                    context="{                                  
                                                'search_default_treatment': active_id,
                                            }"                                          
                                    >
                                    <field string="Reco Ndyag" name="nr_services_ndyag" widget="statinfo"/>
                                </button>


                                <!-- Nr of Services - Med --> 
                                <button type="action" class="oe_stat_button" icon="fa-list"
                                    name="%(service_medical_list_action)d"  
                                    attrs="{ 'invisible':[  ('nr_services_medical','=',0), ]}"

                                    context="{                                  
                                                'search_default_treatment': active_id,
                                            }"                                          
                                    >
                                    <field string="Reco TM" name="nr_services_medical" widget="statinfo"/>
                                </button>


                                <!-- Nr of Services - Cosmeto -->
                                <button type="action" class="oe_stat_button" icon="fa-list"
                                    name="%(service_cosmetology_list_action)d"  
                                    attrs="{ 'invisible':[  ('nr_services_cosmetology','=',0), ]}"
                                    context="{                                  
                                                'search_default_treatment': active_id,
                                            }"                                          
                                    >
                                    <field string="Reco Cosmia" name="nr_services_cosmetology" widget="statinfo"/>
                                </button>


                                <!-- Nr Budgets Pro - IMPORTANT -->
                                <button type="action" class="oe_stat_button" icon="fa-list"
                                        name="%(order_form_tre_action)d"
                                        context="{                                  
                                                    'search_default_patient': patient,
                                                    'default_treatment': active_id,
                                                    'default_x_family': 'procedure', 
                                                }"  

                                        attrs="{ 'invisible':[  ('nr_budgets_pro','=',0), ]}">
                                    <field string="Pres. Creado" name="nr_budgets_pro" widget="statinfo"/>
                                </button>


                                <!-- Invoices - Pro -->
                                <button type="action" class="oe_stat_button" icon="fa-list"
                                        name="%(order_form_tre_action)d"                                    
                                        context="{                                  
                                                    'search_default_patient': patient,
                                                    'default_treatment': active_id,
                                                    'default_x_family': 'procedure', 
                                                }"
                                        attrs="{ 'invisible':[  ('nr_invoices_pro','=',0), ]}"
                                    >
                                    <field string="Venta - Pro" name="nr_invoices_pro" widget="statinfo"/>
                                </button>


                                <!-- Procedures -->
                                <button type="action" class="oe_stat_button" 
                                    name="%(procedure_form_action)d"
                                    context="{                                  
                                            'search_default_treatment': active_id,
                                            }"
                                    icon="fa-list"
                                    attrs="{ 'invisible':[  ('nr_procedures','=',0), ]}"
                                    >
                                    <field string="Proc" name="nr_procedures" widget="statinfo"/>
                                </button>
                        

                                <!-- Sessions -->
                                <button type="action" class="oe_stat_button"
                                    name="%(session_med_form_action)d"
                                    context="{                                  
                                            'search_default_treatment': active_id,
                                            }"
                                    icon="fa-list"
                                    attrs="{ 'invisible':[  ('nr_sessions','=',0), ]}"
                                    >
                                    <field string="Sesiones" name="nr_sessions" widget="statinfo"/>
                                </button>
                        

                                <!-- Controls -->
                                <button type="action" class="oe_stat_button" icon="fa-list"
                                    name="%(control_form_action)d"
                                    context="{                                  
                                            'search_default_treatment': active_id,
                                            }"
                                    attrs="{ 'invisible':[  ('nr_controls','=',0), ]}"
                                    >
                                    <field string="Controles" name="nr_controls" widget="statinfo"/>
                                </button>
                            </div>
                        
                        

<!-- Name --> 
                            <div class="oe_right" >
                                <div class="oe_title" >
                                    <label class="oe_edit_only" for="name" string="Tratamiento #"/>                                    
                                    <h1><field name="name" class="oe_inline"/></h1>
                                </div>
                                <!-- Testing -->
                                <group  groups="openhealth.roots"></group>
                            </div>
                        </div>

                                   
<!-- Fields -->
                        <!-- Padding --> 
                        <group>
                            <group>
                                <field name="patient_sex"       />
                                <field name="patient_age"       />
                                <field name="patient_city"      />
                                <field name="vip" />
                            </group>


                            <!-- Testing --> 
                            <group groups="openhealth.roots">
    <!--
                            <group>
                                <field name="partner_id"        invisible="0"   />                          
                                <field name="vspace" />
                                <field name="pricelist_id" />
                                <field name="x_vip_inprog"/>
                                <field name="x_test"   groups="openhealth.roots"     />
    -->



                                <field name="x_test_scenario"/>
                        </group>



                        <!-- Padding --> 
<!--
                                <field name="user_id"/>
                                <field name="vspace" />
-->




<!-- Manual --> 
                        <group  col="7" >

                            <!-- CONS --> 
                            <group>
                                <button 
                                    type="object" 
                                    class="oe_highlight"
                                    attrs="{ 'invisible':[  ('add_procedures','==',False),  ]}"
                                    name="create_consultation"
                                    string="CONS"
                                />
                            </group>

                            <!-- RECO --> 
                            <group>
                                <button 
                                    type="object" 
                                    class="oe_highlight"
                                    attrs="{ 'invisible':[  ('add_procedures','==',False),  ]}"
                                    name="create_service"
                                    string="RECO"
                                />
                            </group>

                            <!-- PRESU --> 
                            <group>
                                <button 
                                    type="object" 
                                    class="oe_highlight"
                                    attrs="{ 'invisible':[  ('add_procedures','==',False),  ]}"
                                    name="create_order_pro"
                                    string="PRESU" 
                                />
                            </group>

                            <group>
                                <!-- PROC --> 
                                <button 
                                    type="object" 
                                    class="oe_highlight"
                                    attrs="{ 'invisible':[  ('add_procedures','==',False),  ]}"
                                    name="create_procedure_man"
                                    string="PROC" 
                                />

                                <!-- CTRL --> 
<!--                                
                                <button 
                                    type="object" 
                                    class="oe_highlight"
                                    attrs="{ 'invisible':[  ('add_procedures','==',False),  ]}"
                                    name="create_controls"
                                    string="CTRL" 
                                />
-->                             
                            </group>





                            </group>
                            <group></group>
                        </group>




                        <group>
                            <group>
                                <field name="physician"         required="1"/>
                                <field name="vspace" />
                                <field name="chief_complaint"   required="1"/>
                                <field name="vspace" />
                                <field name="active"/>
                            </group>                            
                            <group>
                                <field name="start_date"/>
                                <field name="vspace" />
                                <field name="treatment_closed"  invisible="0"/>
                                <field name="vspace" />
                                <field name="vspace" />



                                <!-- Manual -->
                                <field name="add_procedures"    invisible="1"/>

<!--
                                    groups="openhealth.roots,openhealth.physicians,openhealth.managers,openhealth.directors"
-->
                                <button 
                                    type="object" 
                                    class="oe_highlight"
                                    name="toggle_add_procedures" 
                                    
                                    string="Manual"                                     
                                />
                            </group>
                        </group>

                        <!-- Padding -->
                        <group>
                            <group></group>
                            <group></group>
                        </group>


                        <!-- Notebook --> 
                        <notebook>
<!--
                            <page string="Electronic">
                                <field name="electronic_order"/>
                            </page>
-->
                        </notebook>

                    </sheet>
                </form>
            </field>
        </record>
        <!-- FORM --> 





<!-- FORM 2 --> 
        <record model="ir.ui.view" id="treatment_2_form_view">
            <field name="name">treatment.form</field>
            <field name="model">openhealth.treatment</field>
            <field name="priority" eval="5"/>
            <field name="arch" type="xml">
                <form string="Treatment 2 Form">
                    <header>

                            <!-- CO2 --> 
                            <button 
                                type="object" 
                                class="oe_highlight"    
                                name="create_service_co2"
                                string="LASER CO2"
                            />

                            <!-- Quick --> 
                            <button 
                                type="object" 
                                class="oe_highlight"    
                                name="create_service_quick"
                                string="QUICK LASER"
                            />

                            <!-- Excilite -->
                            <button 
                                type="object" 
                                class="oe_highlight"    
                                name="create_service_excilite"
                                string=" EXCILITE"
                            />

                            <!-- M22-IPL --> 
                            <button 
                                type="object" 
                                class="oe_highlight"    
                                name="create_service_ipl"
                                string=" M22-IPL"
                            />

                            <!-- M22-NDYAG -->
                            <button 
                                type="object" 
                                class="oe_highlight"    
                                name="create_service_ndyag"
                                string=" M22-NDYAG"
                            />



                            <!-- Product --> 
                            <button 
                                type="object" 
                                class="oe_highlight"    
                                name="create_service_product"
                                string="PRODUCTOS"
                            />



                            <!-- T. MEDICO -->
                            <button 
                                type="object" 
                                class="oe_highlight"    
                                name="create_service_medical"
                                string="T. MEDICO"
                            />

                            <!-- Cosmeto -->
                            <button 
                                type="object" 
                                class="oe_highlight"    
                                name="create_service_cosmetology"
                                string="Cosmiatria"
                            />
                    </header>
                    <sheet>
                        <notebook></notebook>
                    </sheet>
                </form>
            </field>
        </record>




<!-- TREE --> 
        <record model="ir.ui.view" id="treatment_tree_view">
            <field name="name">treatment.tree</field>
            <field name="model">openhealth.treatment</field>
            <field name="arch" type="xml">

                <tree string="Treatment Tree"
colors="
red:state=='empty';
green:state in ('appointment', 'invoice_consultation', 'consultation', 'service', 'invoice_procedure', 'procedure', 'sessions');
grey:state=='done';
blue:state=='controls'
">
                    <field name="patient"/>                  
                    <field name="x_test"/>
                    <field name="physician"/>
                    <field name="chief_complaint"   string="Motivo"/>
                    <field name="start_date"/>
                    <field name="write_date"    string="Fecha actualizacion"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>



<!--                
                <tree default_order='start_date desc'>
grey:state=='done';
-->

<!--
limit = 40
                    <field name="flag"/>
                    <field name="procedure_ids"     groups="openhealth.roots"/>
-->



<!--
                    <field name="name"/>
                    <field name="patient_sex"/>
                    <field name="patient_age"/>
                    <field name="patient_city"/>

                    <field name="duration"/>
                    <field name="end_date"/>
                    <field name="treatment_open"/>
                    <field name="id"/>
                    <field name="partner_id"/>
                    <field name="nr_appointments"/>                 
                    <field name="nr_consultations"  string="Consultas"  style="text-align:center;"/>
                    <field name="nr_orders"/>
                    <field name="nr_procedures"     string="Procedimientos" style="color:red;"/>
                    <field name="nr_controls"/>
                    <field name="nr_sessions"/>
                    <field name="nr_evaluations"/>
                    <field name="nr_services"/>
                    <field name="price_total"/>
-->
        
        
        
<!-- SEARCH -->
        <record id="view_medical_treatment_filter" model="ir.ui.view">
           <field name="name">Treatment Search</field>
           <field name="model">openhealth.treatment</field>
           <field name="arch" type="xml">
               <search string="Treatments">
                    <field  name="patient" 
                        filter_domain="['|',('patient','ilike',self),('physician','ilike',self)]"/>
                    <group expand="1" string="Group By">
                        <!--
                        <filter name="Estado" context="{'group_by':'state'}"/>
                        -->
                        <filter name="Médico" context="{'group_by':'physician'}"/>
                    </group>
               </search>
           </field>
       </record>


    </data>
</openerp>
